version: '3.7'

services:
  hoerbuchkatalog:
    image: wbh-hbk/hoerbuchkatalog:${hbk.release}
    restart: unless-stopped
    environment:
      - TZ=Europe/Berlin
      - LANG=en_US.UTF-8
      - HOERBUCHKATALOG_TEMPLATE=/var/local/templates
    volumes:
      - hoerbuchkataloglocal:/var/local:rw
    networks:
      - backend
      - frontend
    expose:
      - 1099
      - 5005
      - 8080
  datatransfer-ssh:
    image: wbh-hbk/datatransfer-ssh:${hbk.release}
    restart: unless-stopped
    environment:
      - TZ=Europe/Berlin
      - LANG=en_US.UTF-8
    volumes:
      - datatransfersshconf:/etc/ssh:rw
      - hoerbuchkataloglocal:/var/local/hoerbuchkatalog:rw
    networks:
      - frontend
    expose:
      - 22
  admin-ssh:
    image: wbh-hbk/admin-ssh:${hbk.release}
    restart: unless-stopped
    environment:
      - TZ=Europe/Berlin
      - LANG=en_US.UTF-8
    volumes:
      - adminsshconf:/etc/ssh:rw
      - hoerbuchkataloglocal:/var/local/hoerbuchkatalog:rw
    networks:
      - frontend
    expose:
      - 22

volumes:
  adminsshconf:
    driver: local
  datatransfersshconf:
    driver: local
  hoerbuchkataloglocal:
    driver: local

networks:
  backend:
    name: hbk-backend
    driver: bridge
    external: false
    internal: true
  frontend:
    name: hbk-frontend
    driver: bridge
    external: false
    internal: false
