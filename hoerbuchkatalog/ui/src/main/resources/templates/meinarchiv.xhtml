<!DOCTYPE html>
<html lang="de"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
<!--@elvariable id="hoererSession" type="wbh.bookworm.hoerbuchkatalog.ui.katalog.HoererSession"-->
<!--@elvariable id="meinArchiv" type="wbh.bookworm.hoerbuchkatalog.ui.katalog.MeinArchiv"-->
<ui:composition template="hoerbuchkatalog-ui.xhtml">
    <ui:define name="container">
        <h:panelGroup rendered="#{hoererSession.hoererIstUnbekannt}">
            Leider ist Ihre Hörernummer dem Hörbuchkatalog-System nicht bekannt.<br/>
            Bitte melden Sie sich <a href="/cb-login.html">hier</a> an oder wenden Sie sich an die WBH.
        </h:panelGroup>
        <h:panelGroup rendered="#{hoererSession.hoererIstBekannt}"
                      layout="block" styleClass="leading">
            <h2 class="contentheading ">Mein Hörbucharchiv</h2>
            <div class="contact-data">
                <div class="hoerer">
                    <span class="entry-name">#{hoererSession.hoerername}</span>
                    - Hörernummer:
                    <span class="entry-hrnr">#{hoererSession.hoerernummer}</span>
                </div>
            </div>
            <h:form id="meinArchiv">
                <div class="searchrow">
                    <h3>Suchen Sie innerhalb Ihres Archivs</h3>
                    <h:messages for="suchdatumAb"
                                showDetail="true" showSummary="false"
                                style="color:red"/>
                    <label>Startdatum:</label>
                    <h:inputText value="#{meinArchiv.suchdatumAb}"
                                 validatorMessage="Bitte ein Datum im Format TT.MM.JJJJ eingeben"
                                 id="suchdatumAb"
                                 class="searchdate">
                        <f:validateRegex pattern="\d{1,2}\.\d{1,2}\.\d{4}"/>
                    </h:inputText>
                    (TT.MM.JJJJ)<br/>
                    <label>Suchtitel:</label>
                    <h:inputText value="#{meinArchiv.stichwort}" class="searchtitle"/>
                    <h:commandButton id="archivDurchsuchen"
                                     actionListener="#{meinArchiv.sucheNachStichwort}"
                                     value="Suchen"
                                     styleClass="searchbutton">
                        <f:ajax event="action" execute="@form" render="@all"/>
                    </h:commandButton>
                </div>
                <h:panelGroup rendered="#{!meinArchiv.erledigteBestellkartenVorhanden()}"
                              layout="block" styleClass="row notitle">
                    Es sind keine Bestellungen im Archiv!
                </h:panelGroup>
                <h:panelGroup rendered="#{!meinArchiv.erledigteBestellkartenAnzeigen()}"
                              layout="block" styleClass="row notitle">
                    Es sind keine Bestellungen im Archiv zur Ihrer Suche gefunden worden!
                </h:panelGroup>
                <h:panelGroup rendered="#{meinArchiv.erledigteBestellkartenAnzeigen()}"
                              id="archivTabelle"
                              layout="block" styleClass="row">
                    <div class="col-lg-12">
                        <table class="table table-striped">
                            <tbody>
                            <tr>
                                <th>Titel-Nr.</th>
                                <th>Ausleihdatum</th>
                                <th>Titel/Autor/Dauer</th>
                            </tr>
                            <ui:repeat value="#{meinArchiv.gefilterteErledigteBestellkarten}"
                                       var="erledigteBestellkarte" varStatus="status">
                                <h:outputFormat rendered="#{status.last}">
                                    <tr>
                                        <td colspan="3" class="lastrow">Hinweis: Es folgt der letzte Datensatz</td>
                                    </tr>
                                </h:outputFormat>
                                <tr>
                                    <td>#{erledigteBestellkarte.titelnummer}</td>
                                    <td>#{erledigteBestellkarte.ausleihdatumAufDeutsch}</td>
                                    <td>
                                        <table>
                                            <tbody>
                                            <tr>
                                                <td>#{meinArchiv.titel(erledigteBestellkarte.titelnummer)}</td>
                                            </tr>
                                            <tr>
                                                <td>von #{meinArchiv.autor(erledigteBestellkarte.titelnummer)}</td>
                                            </tr>
                                            <tr>
                                                <td>#{meinArchiv.spieldauer(erledigteBestellkarte.titelnummer)}</td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </ui:repeat>
                            </tbody>
                        </table>
                    </div>
                </h:panelGroup>
            </h:form>
        </h:panelGroup>
        <h:panelGroup rendered="#{hoererSession.hoererIstBekannt}"
                      layout="block" styleClass="noticetext">
        </h:panelGroup>
    </ui:define>
</ui:composition>
</html>
